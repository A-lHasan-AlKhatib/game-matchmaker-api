# --------------------------------------------------------------------
# Variables (override with: make BINARY=foo ...)
# --------------------------------------------------------------------
BINARY ?= main
PKG    ?= ./cmd/game-matchmaker-api
IMAGE  ?= game-matchmaker-api:local

# --------------------------------------------------------------------
# Build / Run
# --------------------------------------------------------------------
build:
	go build -o $(BINARY) $(PKG)

run: build
	./$(BINARY)

# --------------------------------------------------------------------
# Quality
# --------------------------------------------------------------------
tidy:
	go mod tidy && go mod verify

# --------------------------------------------------------------------
# Tests (unit & integration) â€“ keep locally; CI can skip if desired
# --------------------------------------------------------------------
test:
	go test ./...

# --------------------------------------------------------------------
# Docker helpers
# --------------------------------------------------------------------
docker-build:
	docker build -t $(IMAGE) .

# --------------------------------------------------------------------
# Misc
# --------------------------------------------------------------------
clean:
	rm -f $(BINARY)

.PHONY: build run tidy test docker-build clean
